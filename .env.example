# ================================
# n8n Environment Configuration
# ================================
# Copy this file to .env and configure for your environment
# Documentation: https://docs.n8n.io/hosting/configuration/

# ================================
# BASIC CONFIGURATION
# ================================

# n8n instance base URL (required for webhooks, OAuth, and emails)
N8N_EDITOR_BASE_URL=https://your-n8n-domain.com

# Host and port configuration
N8N_HOST=localhost
N8N_PORT=5678
N8N_LISTEN_ADDRESS=0.0.0.0

# Protocol (http or https)
N8N_PROTOCOL=https

# Base path if n8n is behind a reverse proxy
N8N_PATH=/

# Number of reverse proxies n8n is running behind
N8N_PROXY_HOPS=0

# ================================
# SSL CONFIGURATION (if not using reverse proxy)
# ================================

# SSL key and certificate paths
N8N_SSL_KEY=/path/to/ssl/key.pem
N8N_SSL_CERT=/path/to/ssl/cert.pem

# ================================
# DATABASE CONFIGURATION
# ================================

# Database type: sqlite, postgresdb, mariadb, mysqldb
DB_TYPE=postgresdb

# PostgreSQL Configuration
DB_POSTGRESDB_DATABASE=n8n
DB_POSTGRESDB_HOST=localhost
DB_POSTGRESDB_PORT=5432
DB_POSTGRESDB_USER=n8n
DB_POSTGRESDB_PASSWORD=your_database_password
DB_POSTGRESDB_SCHEMA=public

# MySQL/MariaDB Configuration
# DB_MYSQLDB_DATABASE=n8n
# DB_MYSQLDB_HOST=localhost
# DB_MYSQLDB_PORT=3306
# DB_MYSQLDB_USER=n8n
# DB_MYSQLDB_PASSWORD=your_database_password

# SQLite Configuration (for development only)
# DB_SQLITE_LOCATION=/home/node/.n8n/database.sqlite

# Database table prefix (optional)
# DB_TABLE_PREFIX=

# Connection pool settings
DB_POSTGRESDB_POOL_SIZE=2

# ================================
# EXECUTION CONFIGURATION
# ================================

# Execution mode: main, queue
EXECUTIONS_MODE=main

# Save execution data
EXECUTIONS_DATA_SAVE_ON_ERROR=all
EXECUTIONS_DATA_SAVE_ON_SUCCESS=all
EXECUTIONS_DATA_SAVE_ON_PROGRESS=false
EXECUTIONS_DATA_SAVE_MANUAL_EXECUTIONS=true

# Execution timeout (in seconds, -1 for no timeout)
EXECUTIONS_TIMEOUT=3600
EXECUTIONS_TIMEOUT_MAX=3600

# Maximum number of executions to keep in database
EXECUTIONS_DATA_PRUNE=true
EXECUTIONS_DATA_MAX_AGE=336

# ================================
# QUEUE MODE CONFIGURATION (Bull)
# ================================
# Only needed if EXECUTIONS_MODE=queue

# Redis connection
QUEUE_BULL_REDIS_HOST=localhost
QUEUE_BULL_REDIS_PORT=6379
QUEUE_BULL_REDIS_DB=0
QUEUE_BULL_REDIS_PASSWORD=
QUEUE_BULL_REDIS_TIMEOUT_THRESHOLD=10000
QUEUE_BULL_REDIS_USERNAME=
QUEUE_BULL_REDIS_CLUSTER_NODES=

# Queue health check interval (seconds)
QUEUE_HEALTH_CHECK_ACTIVE=false
QUEUE_HEALTH_CHECK_PORT=5678

# Worker configuration
QUEUE_WORKER_TIMEOUT=60

# ================================
# WEBHOOK CONFIGURATION
# ================================

# Webhook URL (usually same as N8N_EDITOR_BASE_URL)
WEBHOOK_URL=https://your-n8n-domain.com

# Test webhook URL (for testing)
N8N_WEBHOOK_TEST_URL=https://your-n8n-domain.com

# ================================
# USER MANAGEMENT & AUTHENTICATION
# ================================

# Disable n8n instance owner setup
# N8N_USER_MANAGEMENT_DISABLED=false

# JWT configuration
N8N_USER_MANAGEMENT_JWT_SECRET=your-jwt-secret-key-change-this
N8N_USER_MANAGEMENT_JWT_DURATION_HOURS=168
N8N_USER_MANAGEMENT_JWT_REFRESH_TIMEOUT_HOURS=0

# Email invitation settings
N8N_INVITE_LINKS_EMAIL_ONLY=false

# ================================
# AZURE AD AUTHENTICATION (MSAL)
# ================================

# Enable Azure AD login
N8N_AZURE_AD_LOGIN_ENABLED=true

# Azure AD Application Configuration
N8N_AZURE_AD_TENANT_ID=your-tenant-id-here
N8N_AZURE_AD_CLIENT_ID=your-client-id-here
N8N_AZURE_AD_CLIENT_SECRET=your-client-secret-here

# Redirect URI (must match Azure AD app registration)
N8N_AZURE_AD_REDIRECT_URI=https://your-n8n-domain.com/rest/azure-ad/callback

# Login button label (optional)
N8N_AZURE_AD_LOGIN_LABEL=Sign in with Microsoft

# Authority URL configuration
# Use tenant-specific authority (recommended for single tenant)
N8N_AZURE_AD_USE_TENANT_AUTHORITY=true
# Or use custom authority (common for multi-tenant)
N8N_AZURE_AD_AUTHORITY=https://login.microsoftonline.com/common

# OAuth scopes to request
N8N_AZURE_AD_SCOPES=openid profile email User.Read

# User provisioning settings
N8N_AZURE_AD_AUTO_CREATE_USER=true
N8N_AZURE_AD_DEFAULT_ROLE=member
N8N_AZURE_AD_SYNC_PROFILE=true

# ================================
# OTHER SSO CONFIGURATIONS
# ================================

# SAML SSO
N8N_SSO_SAML_LOGIN_ENABLED=false
N8N_SSO_SAML_LOGIN_LABEL=

# OIDC SSO
N8N_SSO_OIDC_LOGIN_ENABLED=false

# LDAP
N8N_SSO_LDAP_LOGIN_ENABLED=false
N8N_SSO_LDAP_LOGIN_LABEL=

# Just-in-time provisioning for SSO
N8N_SSO_JUST_IN_TIME_PROVISIONING=true
N8N_SSO_REDIRECT_LOGIN_TO_SSO=true

# SSO Scopes Provisioning
N8N_SSO_SCOPES_PROVISION_INSTANCE_ROLE=false
N8N_SSO_SCOPES_PROVISION_PROJECT_ROLES=false
N8N_SSO_SCOPES_PROVISIONING_FREQUENCY=never
N8N_SSO_SCOPES_NAME=n8n
N8N_SSO_SCOPES_INSTANCE_ROLE_CLAIM_NAME=n8n_instance_role
N8N_SSO_SCOPES_PROJECTS_ROLES_CLAIM_NAME=n8n_projects

# ================================
# EMAIL (SMTP) CONFIGURATION
# ================================

# Email mode: smtp
N8N_EMAIL_MODE=smtp

# SMTP server settings
N8N_SMTP_HOST=smtp.gmail.com
N8N_SMTP_PORT=465
N8N_SMTP_USER=your-email@gmail.com
N8N_SMTP_PASS=your-app-password
N8N_SMTP_SENDER=n8n@your-domain.com

# SMTP security
N8N_SMTP_SSL=true
N8N_SMTP_STARTTLS=false

# OAuth2 for SMTP (Google Workspace)
# N8N_SMTP_OAUTH_SERVICE_CLIENT=
# N8N_SMTP_OAUTH_PRIVATE_KEY=

# Email template paths (optional)
# N8N_UM_EMAIL_TEMPLATES_INVITE=/path/to/invite.hbs
# N8N_UM_EMAIL_TEMPLATES_PWRESET=/path/to/password-reset.hbs
# N8N_UM_EMAIL_TEMPLATES_WORKFLOW_SHARED=/path/to/workflow-shared.hbs
# N8N_UM_EMAIL_TEMPLATES_CREDENTIALS_SHARED=/path/to/credentials-shared.hbs
# N8N_UM_EMAIL_TEMPLATES_PROJECT_SHARED=/path/to/project-shared.hbs

# ================================
# SECURITY
# ================================

# Encryption key (required for credentials)
N8N_ENCRYPTION_KEY=your-encryption-key-change-this

# Cookie settings
# N8N_COOKIE_SAME_SITE=lax
# N8N_COOKIE_SECURE=true

# CORS settings (for API)
# N8N_CORS_ORIGIN=

# ================================
# MULTI-FACTOR AUTHENTICATION (MFA)
# ================================

N8N_MFA_ENABLED=true

# ================================
# WORKFLOWS
# ================================

# Default name for new workflows
N8N_DEFAULT_NAME=My workflow

# Allow manual workflow execution with unfinished workflows
# EXECUTIONS_DATA_HARD_DELETE_BUFFER=1

# ================================
# CREDENTIALS
# ================================

# Overwrite credentials with environment variables
# CREDENTIALS_OVERWRITE_DATA={}
# CREDENTIALS_OVERWRITE_ENDPOINT=

# ================================
# NODES
# ================================

# Custom nodes locations
# N8N_CUSTOM_EXTENSIONS=/path/to/custom/nodes

# Community nodes
# N8N_COMMUNITY_PACKAGES_ENABLED=true

# Python nodes (experimental)
N8N_PYTHON_ENABLED=false

# ================================
# EXTERNAL HOOKS
# ================================

# External hooks file path
# EXTERNAL_FRONTEND_HOOKS_URLS=
# N8N_EXTERNAL_HOOKS=/path/to/external-hooks.js

# ================================
# LOGGING
# ================================

# Log level: error, warn, info, verbose, debug, silly
N8N_LOG_LEVEL=info

# Log output: console, file
N8N_LOG_OUTPUT=console

# Log format: json, pretty
N8N_LOG_FORMAT=pretty

# File logging configuration (when N8N_LOG_OUTPUT=file)
# N8N_LOG_FILE_LOCATION=/logs
# N8N_LOG_FILE_COUNT_MAX=100
# N8N_LOG_FILE_SIZE_MAX=16

# Log scopes (comma-separated)
# N8N_LOG_SCOPES=

# ================================
# METRICS (PROMETHEUS)
# ================================

N8N_METRICS=false
N8N_METRICS_PREFIX=n8n_
N8N_METRICS_INCLUDE_DEFAULT_METRICS=true
N8N_METRICS_INCLUDE_WORKFLOW_ID_LABEL=false
N8N_METRICS_INCLUDE_NODE_TYPE_LABEL=false
N8N_METRICS_INCLUDE_CREDENTIAL_TYPE_LABEL=false
N8N_METRICS_INCLUDE_API_ENDPOINTS=false
N8N_METRICS_INCLUDE_API_PATH_LABEL=false
N8N_METRICS_INCLUDE_API_METHOD_LABEL=false
N8N_METRICS_INCLUDE_API_STATUS_CODE_LABEL=false
N8N_METRICS_INCLUDE_CACHE_METRICS=false
N8N_METRICS_INCLUDE_MESSAGE_EVENT_BUS_METRICS=false
N8N_METRICS_INCLUDE_QUEUE_METRICS=false

# ================================
# PUBLIC API
# ================================

# Enable public API
# N8N_PUBLIC_API_DISABLED=false
# N8N_PUBLIC_API_ENDPOINT=api
# N8N_PUBLIC_API_SWAGGERUI_DISABLED=false

# ================================
# VERSION NOTIFICATIONS
# ================================

N8N_VERSION_NOTIFICATIONS_ENABLED=true
N8N_VERSION_NOTIFICATIONS_ENDPOINT=https://api.n8n.io/api/versions/
N8N_VERSION_NOTIFICATIONS_INFO_URL=https://docs.n8n.io/getting-started/installation/updating.html

# ================================
# TEMPLATES
# ================================

N8N_TEMPLATES_ENABLED=true
N8N_TEMPLATES_HOST=https://api.n8n.io/api/

# ================================
# WORKFLOW HISTORY
# ================================

N8N_WORKFLOW_HISTORY_ENABLED=true
N8N_WORKFLOW_HISTORY_PRUNE_TIME=336

# ================================
# AI FEATURES
# ================================

# AI Assistant
# N8N_AI_ASSISTANT_BASE_URL=

# AI Builder
# N8N_AI_BUILDER_API_KEY=

# ================================
# HIRING BANNER
# ================================

N8N_HIRING_BANNER_ENABLED=true

# ================================
# PERSONALIZATION
# ================================

N8N_PERSONALIZATION_ENABLED=true

# ================================
# DIAGNOSTICS
# ================================

N8N_DIAGNOSTICS_ENABLED=true
N8N_DIAGNOSTICS_CONFIG_BACKEND=https://www.datadoghq-staging.com
N8N_DIAGNOSTICS_CONFIG_FRONTEND=https://www.datadoghq-staging.com

# ================================
# EVENT BUS (ENTERPRISE)
# ================================

# N8N_EVENTBUS_LOGWRITER_ENABLED=true
# N8N_EVENTBUS_CHECKUNSENTINTERVAL=300
# N8N_EVENTBUS_LOGWRITER_KEEPLOGCOUNT=3
# N8N_EVENTBUS_LOGWRITER_MAXFILESIZEINKB=10240

# ================================
# CACHE
# ================================

# Cache backend: memory, redis
# N8N_CACHE_BACKEND=memory
# N8N_CACHE_MEMORY_MAX_SIZE=3145728
# N8N_CACHE_MEMORY_TTL=3600

# Redis cache configuration
# N8N_CACHE_REDIS_HOST=localhost
# N8N_CACHE_REDIS_PORT=6379
# N8N_CACHE_REDIS_DB=0
# N8N_CACHE_REDIS_PASSWORD=
# N8N_CACHE_REDIS_TTL=3600

# ================================
# TASK RUNNERS (ENTERPRISE)
# ================================

# Task runner mode: internal, external
# N8N_RUNNERS_ENABLED=false
# N8N_RUNNERS_MODE=internal
# N8N_RUNNERS_TASK_BROKER_URI=
# N8N_RUNNERS_MAX_PAYLOAD=1024

# ================================
# LICENSE (ENTERPRISE)
# ================================

# N8N_LICENSE_TENANT_ID=
# N8N_LICENSE_ACTIVATION_KEY=
# N8N_LICENSE_SERVER_URL=https://license.n8n.io/v1
# N8N_LICENSE_AUTO_RENEW_ENABLED=true
# N8N_LICENSE_AUTO_RENEW_OFFSET=259200
# N8N_LICENSE_CERT=

# ================================
# SENTRY (ERROR TRACKING)
# ================================

# N8N_SENTRY_DSN=

# ================================
# DEPLOYMENT
# ================================

# Deployment type (for telemetry)
# N8N_DEPLOYMENT_TYPE=default

# ================================
# TIMEZONE
# ================================

# Default timezone for cron nodes
GENERIC_TIMEZONE=America/New_York

# ================================
# LOCALIZATION
# ================================

N8N_DEFAULT_LOCALE=en

# ================================
# MISC
# ================================

# Hide usage statistics page
N8N_HIDE_USAGE_PAGE=false

# Disable node type list at /types
# N8N_BLOCK_FILE_ACCESS_TO_N8N_FILES=false

# Binary data storage mode: default, filesystem, s3
# N8N_DEFAULT_BINARY_DATA_MODE=default
# N8N_BINARY_DATA_TTL=60
# N8N_BINARY_DATA_S3_BUCKET=
# N8N_BINARY_DATA_S3_REGION=
# N8N_BINARY_DATA_S3_ACCESS_KEY_ID=
# N8N_BINARY_DATA_S3_SECRET_ACCESS_KEY=

# Preview mode (for development)
# N8N_PREVIEW_MODE=false

# ================================
# DEVELOPMENT ONLY
# ================================

# Hot reload for custom nodes
# N8N_DEV_RELOAD=false

# Skip authentication in development
# N8N_SKIP_WEBHOOK_DEREGISTRATION_SHUTDOWN=false
