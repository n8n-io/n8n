{
	"createdAt": "2024-03-04T20:38:02.224Z",
	"updatedAt": "2024-03-04T20:38:20.000Z",
	"id": "240",
	"name": "SummarizationChain:Simpe:Refine",
	"active": false,
	"nodes": [
		{
			"parameters": {
				"model": "gpt-3.5-turbo-0125",
				"options": {
					"temperature": 0
				}
			},
			"id": "45a1f508-8bdc-4a59-8245-b910beddac70",
			"name": "OpenAI Chat Model2",
			"type": "@n8n/n8n-nodes-langchain.lmChatOpenAi",
			"typeVersion": 1,
			"position": [1440, 640],
			"credentials": {
				"openAiApi": {
					"id": "Zak03cqeLUOsgkFI",
					"name": "OpenAi account"
				}
			}
		},
		{
			"parameters": {},
			"id": "b1cb6eaf-16f0-4f57-b09d-6893e5c52570",
			"name": "When clicking \"Test workflow\"",
			"type": "n8n-nodes-base.manualTrigger",
			"typeVersion": 1,
			"position": [620, 500]
		},
		{
			"parameters": {
				"jsCode": "return {\n  text: `The dancing plague of 1518, or dance epidemic of 1518 (French: Épidémie dansante de 1518), was a case of dancing mania that occurred in Strasbourg, Alsace (modern-day France), in the Holy Roman Empire from July 1518 to September 1518. Somewhere between 50 and 400 people took to dancing for weeks. There are many theories behind the phenomenon, the most popular being stress-induced mass hysteria, suggested by John Waller. Other theories include ergot and religious explanations. There is controversy concerning the number of deaths.\n\nHistory\nEvents\nThe outbreak began in July 1518 when a woman called Frau Troffea began to dance fervently and uncontrollably in a street in Strasbourg. Troffea kept up the constant dancing for a week. Soon, three dozen others joined in. By August, the \"dancing plague\" had claimed 400 victims. Dancers were beginning to collapse. It is said some even died from a stroke or heart attack. No one knew what caused this reaction, which meant no one understood how to remedy it. By early September, the outbreak began to subside, when the dancers were sent to a mountain shrine to pray for absolution.\n\nHistorical documents, including \"physician notes, cathedral sermons, local and regional chronicles, and even notes issued by the Strasbourg city council\" are clear that the victims danced; it is not known why. Historical sources agree that there was an outbreak of dancing after a single woman started dancing, and the dancing did not seem to die down. It lasted for such a long time that it even attracted the attention of the authorities; until the council gave up authority to the physicians, who prescribed the afflicted to \"dance themselves free of it.\" There are claims that guild halls were refurbished to accommodate the dancing, as well as musicians and strong people to help keep those dealing with the dancing mania to stay upright. This backfired, and the council was forced to ban public dancing as people danced in fear it was a punishment from Saint Vitus; and to be \"free of sin\" many joined in on the dancing epidemic. The council went as far as to ban music, as well. Those who danced were then ordered to go to the shrine of Saint Vitus, wore red shoes that were sprinkled with holy water and had painted crosses on the tops and soles. They also had to hold small crosses in their hands; and incense and Latin incantations were part of this \"ritual.\" Apparently \"forgiven by Vitus,\" word was spread of a successful ritual and the Dancing Plague had ended.\n\nEvents similar to this are said to have occurred throughout the medieval age including 11th century in Kölbigk, Saxony, where it was believed to be the result of divine judgment . In 15th century Apulia, Italy, a woman was bitten by a tarantula, the venom making her dance convulsively. The only way to cure the bite was to \"shimmy\" and to have the right sort of music available, which was an accepted remedy by scholars like Athanasius Kircher.\n\nContemporaneous explanations included demonic possession and overheated blood.\n\nVeracity of deaths\nControversy exists over whether people ultimately danced to their deaths. Some sources claim that for a period the plague killed around fifteen people per day, but the sources of the city of Strasbourg at the time of the events did not mention the number of deaths, or even if there were fatalities. There do not appear to be any sources related to the events that make note of any fatalities. Ned Pennant-Rea also claims that the final death toll is not known, but if the claims of fifteen people dying per day were true then the toll could be \"into the hundreds.\"\n\nThe main source for the claim is John Waller, who has written several journal articles on the subject and the book A Time to Dance, a Time to Die: The Extraordinary Story of the Dancing Plague of 1518. The sources cited by Waller that mention deaths were all from later accounts of the events. There is also uncertainty around the identity of the initial dancer (either an unnamed woman or \"Frau Troffea\") and the number of dancers involved (somewhere between 50 and 400). Of the six chronicle accounts, four support Lady Troffea as the first dancer.\n\nModern theories\nFood poisoning\nSome believe the dancing could have been brought on by food poisoning caused by the toxic and psychoactive chemical products of ergot fungi (ergotism), which grows commonly on grains (such as rye) used for baking bread. Ergotamine is the main psychoactive product of ergot fungi; it is structurally related to the drug lysergic acid diethylamide (LSD-25) and is the substance from which LSD-25 was originally synthesized. The same fungus has also been implicated in other major historical anomalies, including the Salem witch trials.\n\nIn The Lancet, John Waller argues that \"this theory does not seem tenable, since it is unlikely that those poisoned by ergot could have danced for days at a time. Nor would so many people have reacted to its psychotropic chemicals in the same way. The ergotism theory also fails to explain why almost every outbreak occurred somewhere along the Rhine and Moselle rivers, areas linked by water but with quite different climates and crops\".\n\nStress-induced mass hysteria\nThis could have been an example of fully developed cases of psychogenic movement disorder happening in mass hysteria or mass psychogenic illness, which involves many individuals suddenly exhibiting the same bizarre behavior. The behavior spreads rapidly and broadly in an epidemic pattern. This kind of comportment could have been caused by elevated levels of psychological stress, caused by the ruthless years (even by the rough standards of the early modern period) the people of Alsace were suffering.\n\nWaller speculates that the dancing was \"stress-induced psychosis\" on a mass level, since the region where the people danced was riddled with starvation and disease, and the inhabitants tended to be superstitious. Seven other cases of dancing plague were reported in the same region during the medieval era.\n\nThis psychogenic illness could have created a chorea (from the Greek khoreia meaning \"to dance\"), a situation comprising random and intricate unintentional movements that flit from body part to body part. Diverse choreas (St. Vitus' dance, St. John's dance, and tarantism) were labeled in the Middle Ages referring to the independent epidemics of \"dancing mania\" that happened in central Europe, particularly at the time of the plague.\n\nPop culture and media\nThe event inspired Jonathan Glazer's 2020 short film Strasbourg 1518.\n\nIt was also the inspiration behind the 2022 choral song \"Choreomania\" by Florence and the Machine. It was the third track on the album Dance Fever, which took its title from the song.\n\nThe book series \"A Collection of Utter Speculation\" released a title \"The Dancing Plague: A Collection of Utter Speculation\" in 2022. It is a fictional account about the events that happened in Strasbourg.\n\nThe 2023 novel, The Dance Tree, by Kiran Millwood Hargrave is a fictionalized version of the summer of 1518 in Strasbourg.\n\nThe event is featured as part of the first season of Watcher Entertainment's \"Puppet History\" in the episode \"The Dancing Plague\".`\n}"
			},
			"id": "33936a84-0d38-4fee-9811-7dc020970e73",
			"name": "Set Article",
			"type": "n8n-nodes-base.code",
			"typeVersion": 2,
			"position": [1040, 500]
		},
		{
			"parameters": {
				"assignments": {
					"assignments": [
						{
							"id": "6fa592a3-1cfe-42d7-8d45-a7ec80871e52",
							"name": "baseline_summary",
							"value": "The dancing plague of 1518 in Strasbourg, Alsace involved between 50 and 400 people dancing uncontrollably for weeks. The cause is unknown, with theories including stress-induced mass hysteria and ergot poisoning. The outbreak ended when the dancers prayed for absolution at a shrine. There is controversy over the number of deaths, with some sources claiming up to fifteen deaths per day, but historical documents do not confirm any fatalities. Similar events have been reported throughout history, inspiring various works of pop culture.",
							"type": "string"
						}
					]
				},
				"options": {}
			},
			"id": "0b869175-1a99-4a50-a29b-79aefb30159f",
			"name": "Set Baseline",
			"type": "n8n-nodes-base.set",
			"typeVersion": 3.3,
			"position": [840, 500]
		},
		{
			"parameters": {
				"model": "gpt-3.5-turbo-0125",
				"options": {
					"temperature": 0
				}
			},
			"id": "57d75d06-da61-4a0a-a917-b076cd1e291e",
			"name": "OpenAI Chat Model9",
			"type": "@n8n/n8n-nodes-langchain.lmChatOpenAi",
			"typeVersion": 1,
			"position": [1760, 660],
			"credentials": {
				"openAiApi": {
					"id": "Zak03cqeLUOsgkFI",
					"name": "OpenAi account"
				}
			}
		},
		{
			"parameters": {
				"chunkSize": 4000,
				"options": {
					"summarizationMethodAndPrompts": {
						"values": {
							"summarizationMethod": "refine"
						}
					}
				}
			},
			"id": "eec9288f-1e8e-4331-9ee6-e57fa207be5b",
			"name": "Summary - Simple - Refine",
			"type": "@n8n/n8n-nodes-langchain.chainSummarization",
			"typeVersion": 2,
			"position": [1420, 500]
		},
		{
			"parameters": {
				"code": {
					"execute": {
						"code": "const { loadEvaluator } = require(\"langchain/evaluation\");\n\nconst llm = await this.getInputConnectionData('ai_languageModel', 0);\nconst inputData = this.getInputData();\nconst inputSummary = inputData[0].json.response.text;\nconst baselineSummary = $('Set Baseline').item.json.baseline_summary;\n\nconst evaluator = await loadEvaluator(\"labeled_criteria\", { criteria: 'helpfulness', llm });\n\nconst result = await evaluator.evaluateStrings({\n  input: \"Summarize Wikipedia article about the dancing plague of 1518\",\n  prediction: inputSummary,\n  reference: baselineSummary,\n});\n\n\nreturn [ {json: { ...result } } ];"
					}
				},
				"inputs": {
					"input": [
						{
							"type": "main",
							"maxConnections": 1,
							"required": true
						},
						{
							"type": "ai_languageModel",
							"maxConnections": 1,
							"required": true
						}
					]
				},
				"outputs": {
					"output": [
						{
							"type": "main"
						}
					]
				}
			},
			"id": "2102e067-5b8a-44aa-9362-4db63fac06c2",
			"name": "Evaluate to Baseline4",
			"type": "@n8n/n8n-nodes-langchain.code",
			"typeVersion": 1,
			"position": [1740, 500]
		}
	],
	"connections": {
		"OpenAI Chat Model2": {
			"ai_languageModel": [
				[
					{
						"node": "Summary - Simple - Refine",
						"type": "ai_languageModel",
						"index": 0
					}
				]
			]
		},
		"When clicking \"Test workflow\"": {
			"main": [
				[
					{
						"node": "Set Baseline",
						"type": "main",
						"index": 0
					}
				]
			]
		},
		"Set Article": {
			"main": [
				[
					{
						"node": "Summary - Simple - Refine",
						"type": "main",
						"index": 0
					}
				]
			]
		},
		"Set Baseline": {
			"main": [
				[
					{
						"node": "Set Article",
						"type": "main",
						"index": 0
					}
				]
			]
		},
		"OpenAI Chat Model9": {
			"ai_languageModel": [
				[
					{
						"node": "Evaluate to Baseline4",
						"type": "ai_languageModel",
						"index": 0
					}
				]
			]
		},
		"Summary - Simple - Refine": {
			"main": [
				[
					{
						"node": "Evaluate to Baseline4",
						"type": "main",
						"index": 0
					}
				]
			]
		}
	},
	"settings": {
		"executionOrder": "v1"
	},
	"staticData": null,
	"meta": {
		"templateCredsSetupCompleted": true
	},
	"pinData": {},
	"versionId": "f5380d94-5641-4fce-857c-f5903700382c",
	"triggerCount": 0,
	"tags": []
}
