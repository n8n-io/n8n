{
	"httpRequest": {
		"method": "POST",
		"path": "/v1/messages",
		"body": {
			"contentType": "application/json",
			"type": "JSON",
			"json": {
				"model": "claude-sonnet-4-5",
				"temperature": 0,
				"stream": false,
				"max_tokens": 16000,
				"tools": [
					{
						"name": "routing_decision",
						"description": "A function available to call.",
						"input_schema": {
							"type": "object",
							"properties": {
								"reasoning": {
									"type": "string",
									"description": "One sentence explaining why this agent should act next"
								},
								"next": {
									"type": "string",
									"enum": ["responder", "discovery", "builder", "configurator"],
									"description": "The next agent to call"
								}
							},
							"required": ["reasoning", "next"],
							"additionalProperties": false,
							"$schema": "http://json-schema.org/draft-07/schema#"
						}
					}
				],
				"tool_choice": {
					"type": "tool",
					"name": "routing_decision"
				},
				"thinking": {
					"type": "disabled"
				},
				"messages": [
					{
						"role": "user",
						"content": "Build an n8n workflow that automatically generates YouTube chapter timestamps from video captions. Use the n8n chat trigger for me to enter the URL of the YouTube video. Use the YouTube Get a video node to get the video title, description, and existing metadata. Use the YouTube Captions API to download the transcript for the given video ID. Send the transcript to AI agent using Anthropic's Claude model. Prompt the model to identify topic shifts and return structured output in timestamp - chapter format. Append the generated chapter list to the existing video description. Use the YouTube Update a video node to update the video description. Respond back with the updates using the respond to chat node."
					}
				],
				"system": [
					{
						"type": "text",
						"text": "<role>\nYou are a Supervisor that routes user requests to specialist agents.\n</role>\n\n<available_agents>\n- discovery: Find n8n nodes for building/modifying workflows\n- builder: Create nodes and connections (requires discovery first for new node types)\n- configurator: Set parameters on EXISTING nodes (no structural changes)\n- responder: Answer questions, confirm completion (TERMINAL)\n</available_agents>\n\n<routing_decision_tree>\n1. Is user asking a question or chatting? → responder\n   Examples: \"what does this do?\", \"explain the workflow\", \"thanks\"\n\n2. Does the request involve NEW or DIFFERENT node types? → discovery\n   Examples:\n   - \"Build a workflow that...\" (new workflow)\n   - \"Use [ServiceB] instead of [ServiceA]\" (replacing node type)\n   - \"Add [some integration]\" (new integration)\n   - \"Switch from [ServiceA] to [ServiceB]\" (swapping services)\n\n3. Is the request about connecting/disconnecting existing nodes? → builder\n   Examples: \"Connect node A to node B\", \"Remove the connection to X\"\n\n4. Is the request about changing VALUES in existing nodes? → configurator\n   Examples:\n   - \"Change the URL to https://...\"\n   - \"Set the timeout to 30 seconds\"\n   - \"Update the email subject to...\"\n</routing_decision_tree>\n\n<key_distinction>\n- \"Use [ServiceB] instead of [ServiceA]\" = REPLACEMENT = discovery (new node type needed)\n- \"Change the [ServiceA] API key\" = CONFIGURATION = configurator (same node, different value)\n</key_distinction>\n\n<output>\n- reasoning: One sentence explaining your routing decision\n- next: Agent name\n</output>\n\n<instruction>\nGiven the conversation above, which agent should act next? Provide your reasoning and selection.\n</instruction>",
						"cache_control": {
							"type": "ephemeral"
						}
					}
				]
			},
			"rawBytes": "eyJtb2RlbCI6ImNsYXVkZS1zb25uZXQtNC01IiwidGVtcGVyYXR1cmUiOjAsInN0cmVhbSI6ZmFsc2UsIm1heF90b2tlbnMiOjE2MDAwLCJ0b29scyI6W3sibmFtZSI6InJvdXRpbmdfZGVjaXNpb24iLCJkZXNjcmlwdGlvbiI6IkEgZnVuY3Rpb24gYXZhaWxhYmxlIHRvIGNhbGwuIiwiaW5wdXRfc2NoZW1hIjp7InR5cGUiOiJvYmplY3QiLCJwcm9wZXJ0aWVzIjp7InJlYXNvbmluZyI6eyJ0eXBlIjoic3RyaW5nIiwiZGVzY3JpcHRpb24iOiJPbmUgc2VudGVuY2UgZXhwbGFpbmluZyB3aHkgdGhpcyBhZ2VudCBzaG91bGQgYWN0IG5leHQifSwibmV4dCI6eyJ0eXBlIjoic3RyaW5nIiwiZW51bSI6WyJyZXNwb25kZXIiLCJkaXNjb3ZlcnkiLCJidWlsZGVyIiwiY29uZmlndXJhdG9yIl0sImRlc2NyaXB0aW9uIjoiVGhlIG5leHQgYWdlbnQgdG8gY2FsbCJ9fSwicmVxdWlyZWQiOlsicmVhc29uaW5nIiwibmV4dCJdLCJhZGRpdGlvbmFsUHJvcGVydGllcyI6ZmFsc2UsIiRzY2hlbWEiOiJodHRwOi8vanNvbi1zY2hlbWEub3JnL2RyYWZ0LTA3L3NjaGVtYSMifX1dLCJ0b29sX2Nob2ljZSI6eyJ0eXBlIjoidG9vbCIsIm5hbWUiOiJyb3V0aW5nX2RlY2lzaW9uIn0sInRoaW5raW5nIjp7InR5cGUiOiJkaXNhYmxlZCJ9LCJtZXNzYWdlcyI6W3sicm9sZSI6InVzZXIiLCJjb250ZW50IjoiQnVpbGQgYW4gbjhuIHdvcmtmbG93IHRoYXQgYXV0b21hdGljYWxseSBnZW5lcmF0ZXMgWW91VHViZSBjaGFwdGVyIHRpbWVzdGFtcHMgZnJvbSB2aWRlbyBjYXB0aW9ucy4gVXNlIHRoZSBuOG4gY2hhdCB0cmlnZ2VyIGZvciBtZSB0byBlbnRlciB0aGUgVVJMIG9mIHRoZSBZb3VUdWJlIHZpZGVvLiBVc2UgdGhlIFlvdVR1YmUgR2V0IGEgdmlkZW8gbm9kZSB0byBnZXQgdGhlIHZpZGVvIHRpdGxlLCBkZXNjcmlwdGlvbiwgYW5kIGV4aXN0aW5nIG1ldGFkYXRhLiBVc2UgdGhlIFlvdVR1YmUgQ2FwdGlvbnMgQVBJIHRvIGRvd25sb2FkIHRoZSB0cmFuc2NyaXB0IGZvciB0aGUgZ2l2ZW4gdmlkZW8gSUQuIFNlbmQgdGhlIHRyYW5zY3JpcHQgdG8gQUkgYWdlbnQgdXNpbmcgQW50aHJvcGljJ3MgQ2xhdWRlIG1vZGVsLiBQcm9tcHQgdGhlIG1vZGVsIHRvIGlkZW50aWZ5IHRvcGljIHNoaWZ0cyBhbmQgcmV0dXJuIHN0cnVjdHVyZWQgb3V0cHV0IGluIHRpbWVzdGFtcCAtIGNoYXB0ZXIgZm9ybWF0LiBBcHBlbmQgdGhlIGdlbmVyYXRlZCBjaGFwdGVyIGxpc3QgdG8gdGhlIGV4aXN0aW5nIHZpZGVvIGRlc2NyaXB0aW9uLiBVc2UgdGhlIFlvdVR1YmUgVXBkYXRlIGEgdmlkZW8gbm9kZSB0byB1cGRhdGUgdGhlIHZpZGVvIGRlc2NyaXB0aW9uLiBSZXNwb25kIGJhY2sgd2l0aCB0aGUgdXBkYXRlcyB1c2luZyB0aGUgcmVzcG9uZCB0byBjaGF0IG5vZGUuIn1dLCJzeXN0ZW0iOlt7InR5cGUiOiJ0ZXh0IiwidGV4dCI6Ijxyb2xlPlxuWW91IGFyZSBhIFN1cGVydmlzb3IgdGhhdCByb3V0ZXMgdXNlciByZXF1ZXN0cyB0byBzcGVjaWFsaXN0IGFnZW50cy5cbjwvcm9sZT5cblxuPGF2YWlsYWJsZV9hZ2VudHM+XG4tIGRpc2NvdmVyeTogRmluZCBuOG4gbm9kZXMgZm9yIGJ1aWxkaW5nL21vZGlmeWluZyB3b3JrZmxvd3Ncbi0gYnVpbGRlcjogQ3JlYXRlIG5vZGVzIGFuZCBjb25uZWN0aW9ucyAocmVxdWlyZXMgZGlzY292ZXJ5IGZpcnN0IGZvciBuZXcgbm9kZSB0eXBlcylcbi0gY29uZmlndXJhdG9yOiBTZXQgcGFyYW1ldGVycyBvbiBFWElTVElORyBub2RlcyAobm8gc3RydWN0dXJhbCBjaGFuZ2VzKVxuLSByZXNwb25kZXI6IEFuc3dlciBxdWVzdGlvbnMsIGNvbmZpcm0gY29tcGxldGlvbiAoVEVSTUlOQUwpXG48L2F2YWlsYWJsZV9hZ2VudHM+XG5cbjxyb3V0aW5nX2RlY2lzaW9uX3RyZWU+XG4xLiBJcyB1c2VyIGFza2luZyBhIHF1ZXN0aW9uIG9yIGNoYXR0aW5nPyDihpIgcmVzcG9uZGVyXG4gICBFeGFtcGxlczogXCJ3aGF0IGRvZXMgdGhpcyBkbz9cIiwgXCJleHBsYWluIHRoZSB3b3JrZmxvd1wiLCBcInRoYW5rc1wiXG5cbjIuIERvZXMgdGhlIHJlcXVlc3QgaW52b2x2ZSBORVcgb3IgRElGRkVSRU5UIG5vZGUgdHlwZXM/IOKGkiBkaXNjb3ZlcnlcbiAgIEV4YW1wbGVzOlxuICAgLSBcIkJ1aWxkIGEgd29ya2Zsb3cgdGhhdC4uLlwiIChuZXcgd29ya2Zsb3cpXG4gICAtIFwiVXNlIFtTZXJ2aWNlQl0gaW5zdGVhZCBvZiBbU2VydmljZUFdXCIgKHJlcGxhY2luZyBub2RlIHR5cGUpXG4gICAtIFwiQWRkIFtzb21lIGludGVncmF0aW9uXVwiIChuZXcgaW50ZWdyYXRpb24pXG4gICAtIFwiU3dpdGNoIGZyb20gW1NlcnZpY2VBXSB0byBbU2VydmljZUJdXCIgKHN3YXBwaW5nIHNlcnZpY2VzKVxuXG4zLiBJcyB0aGUgcmVxdWVzdCBhYm91dCBjb25uZWN0aW5nL2Rpc2Nvbm5lY3RpbmcgZXhpc3Rpbmcgbm9kZXM/IOKGkiBidWlsZGVyXG4gICBFeGFtcGxlczogXCJDb25uZWN0IG5vZGUgQSB0byBub2RlIEJcIiwgXCJSZW1vdmUgdGhlIGNvbm5lY3Rpb24gdG8gWFwiXG5cbjQuIElzIHRoZSByZXF1ZXN0IGFib3V0IGNoYW5naW5nIFZBTFVFUyBpbiBleGlzdGluZyBub2Rlcz8g4oaSIGNvbmZpZ3VyYXRvclxuICAgRXhhbXBsZXM6XG4gICAtIFwiQ2hhbmdlIHRoZSBVUkwgdG8gaHR0cHM6Ly8uLi5cIlxuICAgLSBcIlNldCB0aGUgdGltZW91dCB0byAzMCBzZWNvbmRzXCJcbiAgIC0gXCJVcGRhdGUgdGhlIGVtYWlsIHN1YmplY3QgdG8uLi5cIlxuPC9yb3V0aW5nX2RlY2lzaW9uX3RyZWU+XG5cbjxrZXlfZGlzdGluY3Rpb24+XG4tIFwiVXNlIFtTZXJ2aWNlQl0gaW5zdGVhZCBvZiBbU2VydmljZUFdXCIgPSBSRVBMQUNFTUVOVCA9IGRpc2NvdmVyeSAobmV3IG5vZGUgdHlwZSBuZWVkZWQpXG4tIFwiQ2hhbmdlIHRoZSBbU2VydmljZUFdIEFQSSBrZXlcIiA9IENPTkZJR1VSQVRJT04gPSBjb25maWd1cmF0b3IgKHNhbWUgbm9kZSwgZGlmZmVyZW50IHZhbHVlKVxuPC9rZXlfZGlzdGluY3Rpb24+XG5cbjxvdXRwdXQ+XG4tIHJlYXNvbmluZzogT25lIHNlbnRlbmNlIGV4cGxhaW5pbmcgeW91ciByb3V0aW5nIGRlY2lzaW9uXG4tIG5leHQ6IEFnZW50IG5hbWVcbjwvb3V0cHV0PlxuXG48aW5zdHJ1Y3Rpb24+XG5HaXZlbiB0aGUgY29udmVyc2F0aW9uIGFib3ZlLCB3aGljaCBhZ2VudCBzaG91bGQgYWN0IG5leHQ/IFByb3ZpZGUgeW91ciByZWFzb25pbmcgYW5kIHNlbGVjdGlvbi5cbjwvaW5zdHJ1Y3Rpb24+IiwiY2FjaGVfY29udHJvbCI6eyJ0eXBlIjoiZXBoZW1lcmFsIn19XX0="
		}
	},
	"httpResponse": {
		"statusCode": 200,
		"reasonPhrase": "OK",
		"headers": {
			"x-envoy-upstream-service-time": ["2843"],
			"strict-transport-security": ["max-age=31536000; includeSubDomains; preload"],
			"request-id": ["req_011CX3pLt4SQ9iEyt7WZJ7mo"],
			"cf-cache-status": ["DYNAMIC"],
			"anthropic-ratelimit-tokens-reset": ["2026-01-12T16:41:47Z"],
			"anthropic-ratelimit-tokens-remaining": ["15499000"],
			"anthropic-ratelimit-tokens-limit": ["15500000"],
			"anthropic-ratelimit-output-tokens-reset": ["2026-01-12T16:41:48Z"],
			"anthropic-ratelimit-output-tokens-remaining": ["500000"],
			"anthropic-ratelimit-output-tokens-limit": ["500000"],
			"anthropic-ratelimit-input-tokens-reset": ["2026-01-12T16:41:47Z"],
			"anthropic-ratelimit-input-tokens-remaining": ["14999000"],
			"anthropic-ratelimit-input-tokens-limit": ["15000000"],
			"X-Robots-Tag": ["none"],
			"Server": ["cloudflare"],
			"Date": ["Mon, 12 Jan 2026 16:41:48 GMT"],
			"Content-Type": ["application/json"],
			"CF-RAY": ["9bce1a6d5c25f971-PRG"]
		},
		"body": {
			"contentType": "application/json",
			"type": "JSON",
			"json": {
				"model": "claude-sonnet-4-5-20250929",
				"id": "msg_014nQU1xG4xPk35B7mLso9tf",
				"type": "message",
				"role": "assistant",
				"content": [
					{
						"type": "tool_use",
						"id": "toolu_01WuNQTJkBWqtWv9tmZ7YWXr",
						"name": "routing_decision",
						"input": {
							"reasoning": "The user is requesting to build a new workflow with specific node types (n8n chat trigger, YouTube nodes, Anthropic Claude, respond to chat), which requires discovering the appropriate nodes first.",
							"next": "discovery"
						}
					}
				],
				"stop_reason": "tool_use",
				"stop_sequence": null,
				"usage": {
					"input_tokens": 1313,
					"cache_creation_input_tokens": 0,
					"cache_read_input_tokens": 0,
					"cache_creation": {
						"ephemeral_5m_input_tokens": 0,
						"ephemeral_1h_input_tokens": 0
					},
					"output_tokens": 88,
					"service_tier": "standard"
				}
			},
			"rawBytes": "eyJtb2RlbCI6ImNsYXVkZS1zb25uZXQtNC01LTIwMjUwOTI5IiwiaWQiOiJtc2dfMDE0blFVMXhHNHhQazM1QjdtTHNvOXRmIiwidHlwZSI6Im1lc3NhZ2UiLCJyb2xlIjoiYXNzaXN0YW50IiwiY29udGVudCI6W3sidHlwZSI6InRvb2xfdXNlIiwiaWQiOiJ0b29sdV8wMVd1TlFUSmtCV3F0V3Y5dG1aN1lXWHIiLCJuYW1lIjoicm91dGluZ19kZWNpc2lvbiIsImlucHV0Ijp7InJlYXNvbmluZyI6IlRoZSB1c2VyIGlzIHJlcXVlc3RpbmcgdG8gYnVpbGQgYSBuZXcgd29ya2Zsb3cgd2l0aCBzcGVjaWZpYyBub2RlIHR5cGVzIChuOG4gY2hhdCB0cmlnZ2VyLCBZb3VUdWJlIG5vZGVzLCBBbnRocm9waWMgQ2xhdWRlLCByZXNwb25kIHRvIGNoYXQpLCB3aGljaCByZXF1aXJlcyBkaXNjb3ZlcmluZyB0aGUgYXBwcm9wcmlhdGUgbm9kZXMgZmlyc3QuIiwibmV4dCI6ImRpc2NvdmVyeSJ9fV0sInN0b3BfcmVhc29uIjoidG9vbF91c2UiLCJzdG9wX3NlcXVlbmNlIjpudWxsLCJ1c2FnZSI6eyJpbnB1dF90b2tlbnMiOjEzMTMsImNhY2hlX2NyZWF0aW9uX2lucHV0X3Rva2VucyI6MCwiY2FjaGVfcmVhZF9pbnB1dF90b2tlbnMiOjAsImNhY2hlX2NyZWF0aW9uIjp7ImVwaGVtZXJhbF81bV9pbnB1dF90b2tlbnMiOjAsImVwaGVtZXJhbF8xaF9pbnB1dF90b2tlbnMiOjB9LCJvdXRwdXRfdG9rZW5zIjo4OCwic2VydmljZV90aWVyIjoic3RhbmRhcmQifX0="
		},
		"delay": {
			"timeUnit": "MILLISECONDS",
			"value": 2000
		}
	},
	"id": "1768236115212-unknown-host-POST-_v1_messages-2bb8783c.json",
	"priority": 0,
	"timeToLive": {
		"unlimited": true
	},
	"times": {
		"unlimited": true
	}
}
