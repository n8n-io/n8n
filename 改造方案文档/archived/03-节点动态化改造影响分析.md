# n8n èŠ‚ç‚¹åŠ¨æ€åŒ–æ”¹é€ å½±å“åˆ†ææŠ¥å‘Š

> **åˆ†ææ—¥æœŸï¼š** 2025-11-07
> **åˆ†æèŒƒå›´ï¼š** nodes-base (530 ä¸ªèŠ‚ç‚¹) + nodes-langchain (114 ä¸ªèŠ‚ç‚¹)

---

## ä¸€ã€èŠ‚ç‚¹ç»Ÿè®¡æ•°æ®

### 1.1 nodes-base åŒ…ï¼ˆæ™®é€šèŠ‚ç‚¹ï¼‰

| åˆ†ç±» | æ•°é‡ | å æ¯” | è¯´æ˜ |
|------|------|------|------|
| **éœ€è¦é…ç½®çš„èŠ‚ç‚¹** | 433 | 81.7% | æœ‰ credentials å®šä¹‰ |
| **çº¯åŠŸèƒ½èŠ‚ç‚¹** | 97 | 18.3% | æ—  credentials å®šä¹‰ |
| **æ€»è®¡** | 530 | 100% | - |

### 1.2 nodes-langchain åŒ…ï¼ˆAI èŠ‚ç‚¹ï¼‰

| åˆ†ç±» | æ•°é‡ | å æ¯” |
|------|------|------|
| **éœ€è¦é…ç½®çš„èŠ‚ç‚¹** | 72 | 63.2% |
| **çº¯åŠŸèƒ½èŠ‚ç‚¹** | 42 | 36.8% |
| **æ€»è®¡** | 114 | 100% |

### 1.3 æ±‡æ€»

| ç±»å‹ | éœ€è¦é…ç½® | çº¯åŠŸèƒ½ | æ€»è®¡ |
|------|---------|--------|------|
| **æ™®é€šèŠ‚ç‚¹** | 433 | 97 | 530 |
| **AI èŠ‚ç‚¹** | 72 | 42 | 114 |
| **æ€»è®¡** | 505 | 139 | 644 |
| **å æ¯”** | 78.4% | 21.6% | 100% |

---

## äºŒã€çº¯åŠŸèƒ½èŠ‚ç‚¹è¯¦ç»†æ¸…å•

### 2.1 æ•°æ®è½¬æ¢ç±»ï¼ˆ34 ä¸ªï¼‰

**ç‰¹ç‚¹ï¼šçº¯è®¡ç®—ï¼Œæ— éœ€ä»»ä½•å¤–éƒ¨ API**

```
- Codeï¼ˆä»£ç æ‰§è¡Œï¼‰
- Set / Edit Fieldsï¼ˆè®¾ç½®å­—æ®µå€¼ï¼‰
- Mergeï¼ˆåˆå¹¶æ•°æ®ï¼‰
- Filterï¼ˆè¿‡æ»¤ï¼‰
- Sortï¼ˆæ’åºï¼‰
- Aggregateï¼ˆèšåˆï¼‰
- Split Outï¼ˆæ‹†åˆ†ï¼‰
- Limitï¼ˆé™åˆ¶æ•°é‡ï¼‰
- Remove Duplicatesï¼ˆå»é‡ï¼‰
- Compare Datasetsï¼ˆæ¯”è¾ƒæ•°æ®é›†ï¼‰
- Date & Timeï¼ˆæ—¥æœŸæ—¶é—´å¤„ç†ï¼‰
- Cryptoï¼ˆåŠ å¯†è§£å¯†ï¼‰
- Compressionï¼ˆå‹ç¼©è§£å‹ï¼‰
- HTML Extractï¼ˆHTML æå–ï¼‰
- XMLï¼ˆXML å¤„ç†ï¼‰
- Spreadsheet Fileï¼ˆExcel å¤„ç†ï¼‰
- Rename Keysï¼ˆé‡å‘½åé”®ï¼‰
- Extraction Valuesï¼ˆæå–å€¼ï¼‰
- Summarizeï¼ˆæ±‡æ€»ï¼‰
```

### 2.2 æµç¨‹æ§åˆ¶ç±»ï¼ˆ11 ä¸ªï¼‰

**ç‰¹ç‚¹ï¼šæ§åˆ¶å·¥ä½œæµæ‰§è¡Œé€»è¾‘**

```
- Ifï¼ˆæ¡ä»¶åˆ¤æ–­ï¼‰
- Switchï¼ˆå¤šåˆ†æ”¯ï¼‰
- Loop Over Itemsï¼ˆå¾ªç¯ï¼‰
- Split In Batchesï¼ˆæ‰¹å¤„ç†ï¼‰
- Wait Amountï¼ˆç­‰å¾…ï¼‰
- Execute Sub-workflowï¼ˆæ‰§è¡Œå­å·¥ä½œæµï¼‰
- No Operationï¼ˆç©ºæ“ä½œï¼‰
- Simulateï¼ˆæ¨¡æ‹Ÿï¼‰
- Stop and Errorï¼ˆåœæ­¢å’Œé”™è¯¯ï¼‰
```

### 2.3 è§¦å‘å™¨ç±»ï¼ˆ11 ä¸ªï¼‰

**ç‰¹ç‚¹ï¼šæ— éœ€å¤–éƒ¨ API çš„è§¦å‘å™¨**

```
- Manual Triggerï¼ˆæ‰‹åŠ¨è§¦å‘ï¼‰
- Schedule Triggerï¼ˆå®šæ—¶è§¦å‘ï¼‰
- Cronï¼ˆCron å®šæ—¶ï¼‰
- Intervalï¼ˆé—´éš”è§¦å‘ï¼‰
- Webhookï¼ˆWebhook æ¥æ”¶ï¼‰
- Execute Workflow Triggerï¼ˆå·¥ä½œæµè§¦å‘ï¼‰
- Error Triggerï¼ˆé”™è¯¯è§¦å‘ï¼‰
- Local File Triggerï¼ˆæœ¬åœ°æ–‡ä»¶è§¦å‘ï¼‰
- RSS Feed Triggerï¼ˆRSS è§¦å‘ï¼‰
- n8n Triggerï¼ˆn8n å†…éƒ¨è§¦å‘ï¼‰
- n8n Form Triggerï¼ˆè¡¨å•è§¦å‘ï¼‰
```

### 2.4 æ–‡ä»¶æ“ä½œç±»ï¼ˆ14 ä¸ªï¼‰

**ç‰¹ç‚¹ï¼šæœ¬åœ°æ–‡ä»¶è¯»å†™ï¼Œæ— éœ€å¤–éƒ¨æœåŠ¡**

```
- Read Binary Fileï¼ˆè¯»äºŒè¿›åˆ¶æ–‡ä»¶ï¼‰
- Write Binary Fileï¼ˆå†™äºŒè¿›åˆ¶æ–‡ä»¶ï¼‰
- Read Binary Filesï¼ˆæ‰¹é‡è¯»æ–‡ä»¶ï¼‰
- Read PDFï¼ˆè¯» PDFï¼‰
- Read/Write Files from Diskï¼ˆæ–‡ä»¶è¯»å†™ï¼‰
- Convert to Fileï¼ˆè½¬æ¢ä¸ºæ–‡ä»¶ï¼‰
- Extract from Fileï¼ˆä»æ–‡ä»¶æå–ï¼‰
- Convert to/from binary dataï¼ˆäºŒè¿›åˆ¶è½¬æ¢ï¼‰
```

### 2.5 å·¥å…·ç±»ï¼ˆ17 ä¸ªï¼‰

**ç‰¹ç‚¹ï¼šåŸºç¡€åŠŸèƒ½æˆ–å…¬å¼€ API**

```
- Sticky Noteï¼ˆæ³¨é‡Šï¼‰
- Startï¼ˆå¼€å§‹ï¼‰
- Execution Dataï¼ˆæ‰§è¡Œæ•°æ®ï¼‰
- RSS Readï¼ˆRSS é˜…è¯»ï¼‰
- E2E Testï¼ˆæµ‹è¯•ï¼‰
- CoinGeckoï¼ˆå…¬å¼€ APIï¼Œæ— éœ€ Keyï¼‰
- Hacker Newsï¼ˆå…¬å¼€ APIï¼‰
- OpenThesaurusï¼ˆå…¬å¼€ APIï¼‰
- QuickChartï¼ˆå…¬å¼€ APIï¼‰
- Wikipediaï¼ˆå…¬å¼€ APIï¼ŒAI Toolï¼‰
- Calculatorï¼ˆè®¡ç®—å™¨ï¼ŒAI Toolï¼‰
- HTTP Request Toolï¼ˆAI Toolï¼‰
- Code Toolï¼ˆAI Toolï¼‰
```

### 2.6 AI åŠŸèƒ½ç±»ï¼ˆ42 ä¸ªï¼‰

**ç‰¹ç‚¹ï¼šAI ç›¸å…³çš„çº¯åŠŸèƒ½èŠ‚ç‚¹ï¼Œæ— éœ€ credentials**

#### Chains & Parsers
```
- Information Extractorï¼ˆä¿¡æ¯æå–ï¼‰
- Sentiment Analysisï¼ˆæƒ…æ„Ÿåˆ†æï¼‰
- Auto-fixing Output Parserï¼ˆè‡ªåŠ¨ä¿®å¤è§£æå™¨ï¼‰
- Item List Output Parserï¼ˆåˆ—è¡¨è§£æå™¨ï¼‰
- Structured Output Parserï¼ˆç»“æ„åŒ–è§£æå™¨ï¼‰
```

#### Text Splitters
```
- Recursive Character Text Splitter
- Character Text Splitter
- Token Splitter
```

#### Document Loaders
```
- Binary Input Loader
- JSON Input Loader
```

#### Memory
```
- Simple Memoryï¼ˆBuffer Window Memoryï¼‰
- Chat Memory Manager
- Chat Messages Retriever
```

#### Retrievers
```
- Contextual Compression Retriever
- MultiQuery Retriever
- Workflow Retriever
```

#### Vector Store
```
- In Memory Vector Store Insert
- In Memory Vector Store Load
- Vector Store Question Answer Tool
- Vector Store Retriever
```

#### Other
```
- LangChain Code
- Manual Chat Trigger
- Model Selector
- Tool Executor
- Guardrails
```

---

## ä¸‰ã€å½“å‰å·¥ä½œæµæ‰§è¡Œæµç¨‹

### 3.1 èŠ‚ç‚¹åŠ è½½æœºåˆ¶

```
æœåŠ¡å™¨å¯åŠ¨
  â†“
LoadNodesAndCredentials.init()
  â†“
æ‰«æ node_modules
  â”œâ”€ n8n-nodes-base/dist/nodes/
  â””â”€ @n8n/nodes-langchain/dist/nodes/
  â†“
è§£ææ¯ä¸ªèŠ‚ç‚¹çš„ .node.json
  â”œâ”€ è¯»å–èŠ‚ç‚¹æè¿°ï¼ˆdisplayName, group, credentials ç­‰ï¼‰
  â”œâ”€ è®°å½•èŠ‚ç‚¹è·¯å¾„ï¼ˆsourcePathï¼‰
  â””â”€ åŠ¨æ€å¯¼å…¥èŠ‚ç‚¹ç±»
  â†“
å­˜å‚¨åˆ°å†…å­˜
  â”œâ”€ known.nodesï¼ˆèŠ‚ç‚¹å…ƒæ•°æ®ï¼‰
  â””â”€ loaded.nodesï¼ˆèŠ‚ç‚¹å®ä¾‹ï¼‰
```

### 3.2 å·¥ä½œæµæ‰§è¡Œæµç¨‹

```
ç”¨æˆ·æ‰§è¡Œå·¥ä½œæµ
  â†“
WorkflowRunner.run(data)
  â†“
éå† workflow.nodes
  â†“
å¯¹æ¯ä¸ªèŠ‚ç‚¹ï¼š
  NodeTypes.getByNameAndVersion(nodeName, version)
    â†“
  ä»å†…å­˜ä¸­è·å–èŠ‚ç‚¹å®ä¾‹
    LoadNodesAndCredentials.getNode(nodeName)
    â†“
  æ£€æŸ¥ credentials
    CredentialsPermissionChecker.check()
    â†“
  æ‰§è¡ŒèŠ‚ç‚¹
    node.execute(context)
    â†“
  è¿”å›ç»“æœ
```

---

## å››ã€åŠ¨æ€åŒ–æ”¹é€ æ–¹æ¡ˆ

### 4.1 æ¨èæ¶æ„ï¼šé™æ€ + åŠ¨æ€æ··åˆæ¨¡å¼

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚  é™æ€èŠ‚ç‚¹ï¼ˆ139 ä¸ªï¼‰                         â”‚
â”‚  â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”  â”‚
â”‚  âœ“ çº¯åŠŸèƒ½èŠ‚ç‚¹                              â”‚
â”‚  âœ“ ç¼–è¯‘åˆ° nodes.json                       â”‚
â”‚  âœ“ æœåŠ¡å™¨å¯åŠ¨æ—¶åŠ è½½                        â”‚
â”‚  âœ“ å­˜å‚¨åœ¨å†…å­˜ä¸­                            â”‚
â”‚  âœ“ æ— éœ€æ•°æ®åº“æŸ¥è¯¢                          â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                    â†“
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚  åŠ¨æ€èŠ‚ç‚¹ï¼ˆ505 ä¸ªï¼‰                         â”‚
â”‚  â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”  â”‚
â”‚  âœ“ éœ€è¦é…ç½®çš„èŠ‚ç‚¹                          â”‚
â”‚  âœ“ å­˜å‚¨åœ¨æ•°æ®åº“                            â”‚
â”‚  âœ“ é€šè¿‡ API åŠ è½½                           â”‚
â”‚  âœ“ é…ç½®åŠ¨æ€æ³¨å…¥                            â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

### 4.2 èŠ‚ç‚¹åŠ è½½æµç¨‹å¯¹æ¯”

#### æ”¹é€ å‰ï¼ˆç°åœ¨ï¼‰
```typescript
// æ‰€æœ‰èŠ‚ç‚¹éƒ½åœ¨å¯åŠ¨æ—¶åŠ è½½
LoadNodesAndCredentials.init()
  â†’ æ‰«ææ‰€æœ‰èŠ‚ç‚¹æ–‡ä»¶
  â†’ åŠ è½½åˆ°å†…å­˜
  â†’ 644 ä¸ªèŠ‚ç‚¹å…¨éƒ¨é¢„åŠ è½½
```

#### æ”¹é€ åï¼ˆæ··åˆæ¨¡å¼ï¼‰
```typescript
// 1. é™æ€èŠ‚ç‚¹ï¼ˆå¯åŠ¨æ—¶ï¼‰
LoadStaticNodes.init()
  â†’ åŠ è½½ 139 ä¸ªçº¯åŠŸèƒ½èŠ‚ç‚¹
  â†’ ç¼–è¯‘åˆ° nodes.json
  â†’ å‰ç«¯ç›´æ¥åŠ è½½

// 2. åŠ¨æ€èŠ‚ç‚¹ï¼ˆè¿è¡Œæ—¶ï¼‰
async function loadDynamicNode(nodeName: string) {
  // æŸ¥è¯¢æ•°æ®åº“
  const nodeConfig = await db.query(`
    SELECT * FROM managed_nodes
    WHERE node_name = $1
  `, [nodeName]);

  // åŠ è½½èŠ‚ç‚¹ç±»
  const NodeClass = await import(nodeConfig.sourcePath);

  // æ³¨å…¥é…ç½®
  if (nodeConfig.type === 'platform_configured') {
    // å¹³å°é…ç½®çš„èŠ‚ç‚¹ï¼ˆAI æ¨¡å‹ï¼‰
    const platformConfig = await getPlatformConfig(nodeName);
    return createNodeWithPlatformConfig(NodeClass, platformConfig);
  } else {
    // ç”¨æˆ·é…ç½®çš„èŠ‚ç‚¹ï¼ˆç¬¬ä¸‰æ–¹æœåŠ¡ï¼‰
    return createNodeWithUserConfig(NodeClass);
  }
}
```

---

## äº”ã€æ”¹é€ å¯¹å·¥ä½œæµæ‰§è¡Œçš„å½±å“åˆ†æ

### 5.1 é™æ€èŠ‚ç‚¹ï¼ˆæ— å½±å“ï¼‰

| èŠ‚ç‚¹ç±»å‹ | æ”¹é€ å‰ | æ”¹é€ å | å½±å“ |
|---------|--------|--------|------|
| åŠ è½½æ–¹å¼ | å¯åŠ¨æ—¶ä»ç£ç›˜åŠ è½½ | å¯åŠ¨æ—¶ä»ç£ç›˜åŠ è½½ | âœ… æ— å˜åŒ– |
| å­˜å‚¨ä½ç½® | å†…å­˜ | å†…å­˜ | âœ… æ— å˜åŒ– |
| æ‰§è¡Œæ–¹å¼ | `node.execute()` | `node.execute()` | âœ… æ— å˜åŒ– |
| æ€§èƒ½ | ç›´æ¥è°ƒç”¨ | ç›´æ¥è°ƒç”¨ | âœ… æ— å˜åŒ– |

**ç»“è®ºï¼š** çº¯åŠŸèƒ½èŠ‚ç‚¹ä¿æŒç°æœ‰æœºåˆ¶ï¼Œ**å®Œå…¨æ— å½±å“**ã€‚

---

### 5.2 åŠ¨æ€èŠ‚ç‚¹ï¼ˆéœ€è¦è¯„ä¼°ï¼‰

#### A. å¹³å°é…ç½®èŠ‚ç‚¹ï¼ˆAI æ¨¡å‹ + Embeddingsï¼‰

**æ”¹é€ å‰ï¼š**
```typescript
// ç”¨æˆ·åˆ›å»ºå‡­è¯
credentials = await Credentials.get('openAiApi', userId);

// èŠ‚ç‚¹ä½¿ç”¨å‡­è¯
const apiKey = await credentials.getData('apiKey');
const openai = new OpenAI({ apiKey });
```

**æ”¹é€ åï¼š**
```typescript
// å¹³å°ç»Ÿä¸€é…ç½®ï¼ˆæ•°æ®åº“ï¼‰
const platformConfig = await db.query(`
  SELECT api_config
  FROM platform_services
  WHERE service_key = 'openai'
`);

// èŠ‚ç‚¹ä½¿ç”¨å¹³å°é…ç½®
const apiKey = decrypt(platformConfig.api_config.apiKey);
const openai = new OpenAI({ apiKey });

// è®°å½•ä½¿ç”¨é‡
await recordUsage(workspaceId, 'openai', tokens);
```

**å½±å“è¯„ä¼°ï¼š**
- âœ… æ‰§è¡Œé€»è¾‘ä¸å˜ï¼ˆä»ç„¶è°ƒç”¨ OpenAI APIï¼‰
- âœ… èŠ‚ç‚¹ä»£ç ä¸å˜ï¼ˆä»ç„¶æ˜¯ `execute()` æ–¹æ³•ï¼‰
- âš ï¸ é…ç½®æ¥æºæ”¹å˜ï¼ˆä»ç”¨æˆ·å‡­è¯ â†’ å¹³å°é…ç½®ï¼‰
- âš ï¸ å¢åŠ æ•°æ®åº“æŸ¥è¯¢ï¼ˆæ¯æ¬¡æ‰§è¡Œéœ€è¦æŸ¥è¯¢å¹³å°é…ç½®ï¼‰
- âš ï¸ å¢åŠ ä½¿ç”¨é‡è®°å½•ï¼ˆéœ€è¦è®°å½•åˆ°è®¡è´¹ç³»ç»Ÿï¼‰

**æ€§èƒ½å½±å“ï¼š**
- æ•°æ®åº“æŸ¥è¯¢ï¼šçº¦ 2-5ms
- å¯é€šè¿‡ç¼“å­˜ä¼˜åŒ–åˆ° < 1ms

---

#### B. ç”¨æˆ·é…ç½®èŠ‚ç‚¹ï¼ˆç¬¬ä¸‰æ–¹æœåŠ¡ï¼‰

**æ”¹é€ å‰ï¼š**
```typescript
// ç”¨æˆ·åˆ›å»º Notion å‡­è¯
credentials = await Credentials.get('notionApi', userId);
const apiToken = await credentials.getData('apiToken');
const notion = new NotionClient({ auth: apiToken });
```

**æ”¹é€ åï¼ˆæ–¹æ¡ˆ1ï¼šèŠ‚ç‚¹å‚æ•°è¾“å…¥ï¼‰ï¼š**
```typescript
// ç”¨æˆ·ç›´æ¥åœ¨èŠ‚ç‚¹å‚æ•°ä¸­è¾“å…¥
const apiToken = this.getNodeParameter('apiToken', 0);
const notion = new NotionClient({ auth: apiToken });
```

**æ”¹é€ åï¼ˆæ–¹æ¡ˆ2ï¼šWorkspace çº§åˆ«å­˜å‚¨ï¼‰ï¼š**
```typescript
// æŸ¥è¯¢ workspace é…ç½®
const config = await db.query(`
  SELECT config
  FROM workspace_integrations
  WHERE workspace_id = $1 AND service = 'notion'
`, [workspaceId]);

const apiToken = decrypt(config.apiToken);
const notion = new NotionClient({ auth: apiToken });
```

**å½±å“è¯„ä¼°ï¼š**
- âœ… æ‰§è¡Œé€»è¾‘ä¸å˜
- âš ï¸ é…ç½®å­˜å‚¨ä½ç½®æ”¹å˜
  - æ–¹æ¡ˆ1ï¼šèŠ‚ç‚¹å‚æ•°ï¼ˆæ¯ä¸ªèŠ‚ç‚¹å•ç‹¬å­˜å‚¨ï¼‰
  - æ–¹æ¡ˆ2ï¼šWorkspace è¡¨ï¼ˆç»Ÿä¸€å­˜å‚¨ï¼Œå¯å¤ç”¨ï¼‰
- âš ï¸ ç”¨æˆ·ä½“éªŒæ”¹å˜
  - æ”¹é€ å‰ï¼šå…ˆåˆ›å»ºå‡­è¯ â†’ é€‰æ‹©å‡­è¯
  - æ”¹é€ åï¼šç›´æ¥è¾“å…¥ API Key

---

### 5.3 å…³é”®æŠ€æœ¯é£é™©ç‚¹

| é£é™©ç‚¹ | æè¿° | å½±å“ç­‰çº§ | ç¼“è§£æ–¹æ¡ˆ |
|--------|------|---------|---------|
| **èŠ‚ç‚¹åŠ è½½å»¶è¿Ÿ** | åŠ¨æ€èŠ‚ç‚¹é¦–æ¬¡ä½¿ç”¨éœ€è¦æŸ¥è¯¢æ•°æ®åº“ | ğŸŸ¡ ä¸­ | å¯åŠ¨æ—¶é¢„åŠ è½½çƒ­é—¨èŠ‚ç‚¹åˆ°ç¼“å­˜ |
| **é…ç½®ç¼“å­˜å¤±æ•ˆ** | å¹³å°é…ç½®æ›´æ–°åç¼“å­˜ä¸ä¸€è‡´ | ğŸŸ¡ ä¸­ | ä½¿ç”¨ Redis å‘å¸ƒè®¢é˜…é€šçŸ¥æ‰€æœ‰å®ä¾‹ |
| **å‡­è¯è¿ç§»** | ç°æœ‰ç”¨æˆ·çš„å‡­è¯éœ€è¦è¿ç§» | ğŸ”´ é«˜ | æä¾›è¿ç§»è„šæœ¬ + å‘åå…¼å®¹æ¨¡å¼ |
| **è®¡è´¹å‡†ç¡®æ€§** | ä½¿ç”¨é‡è®°å½•å¤±è´¥å¯¼è‡´è®¡è´¹ä¸å‡† | ğŸ”´ é«˜ | äº‹åŠ¡ä¿è¯ + å¼‚æ­¥è¡¥å¿æœºåˆ¶ |
| **å¤šç§Ÿæˆ·éš”ç¦»** | å¹³å°é…ç½®è¢«é”™è¯¯ä½¿ç”¨ | ğŸ”´ é«˜ | Workspace çº§åˆ«é‰´æƒ + é…é¢é™åˆ¶ |

---

## å…­ã€æ‰§è¡Œæµç¨‹å¯¹æ¯”

### 6.1 OpenAI èŠ‚ç‚¹æ‰§è¡Œæµç¨‹

#### æ”¹é€ å‰
```
1. ç”¨æˆ·æ‹–å…¥ OpenAI èŠ‚ç‚¹
2. ç”¨æˆ·é€‰æ‹© OpenAI å‡­è¯
3. æ‰§è¡Œå·¥ä½œæµ
   â†“
4. NodeTypes.getByNameAndVersion('openai')
   â†’ ä»å†…å­˜è·å–èŠ‚ç‚¹å®ä¾‹ï¼ˆ1msï¼‰
   â†“
5. Credentials.get('openAiApi', userId)
   â†’ ä»æ•°æ®åº“æŸ¥è¯¢ç”¨æˆ·å‡­è¯ï¼ˆ3-5msï¼‰
   â†“
6. è§£å¯†å‡­è¯
   â†’ decrypt(credentials.data.apiKey)ï¼ˆ< 1msï¼‰
   â†“
7. è°ƒç”¨ OpenAI API
   â†’ openai.chat.completions.create()ï¼ˆ500-2000msï¼‰
   â†“
8. è¿”å›ç»“æœ

æ€»è€—æ—¶ï¼š504-2006ms
æ•°æ®åº“æŸ¥è¯¢ï¼š1 æ¬¡
```

#### æ”¹é€ åï¼ˆå¹³å°é…ç½®ï¼‰
```
1. ç”¨æˆ·æ‹–å…¥ OpenAI èŠ‚ç‚¹
2. æ— éœ€é…ç½®ï¼Œç›´æ¥ä½¿ç”¨
3. æ‰§è¡Œå·¥ä½œæµ
   â†“
4. NodeTypes.getByNameAndVersion('openai')
   â†’ ä»å†…å­˜è·å–èŠ‚ç‚¹å®ä¾‹ï¼ˆ1msï¼‰
   â†“
5. PlatformService.getConfig('openai')
   â†’ ä» Redis ç¼“å­˜è·å–å¹³å°é…ç½®ï¼ˆ< 1msï¼‰
   â†“
6. è§£å¯†é…ç½®
   â†’ decrypt(platformConfig.apiKey)ï¼ˆ< 1msï¼‰
   â†“
7. è°ƒç”¨ OpenAI API
   â†’ openai.chat.completions.create()ï¼ˆ500-2000msï¼‰
   â†“
8. å¼‚æ­¥è®°å½•ä½¿ç”¨é‡
   â†’ recordUsage(workspaceId, 'openai', tokens)ï¼ˆå¼‚æ­¥ï¼‰
   â†“
9. è¿”å›ç»“æœ

æ€»è€—æ—¶ï¼š502-2002ms
æ•°æ®åº“æŸ¥è¯¢ï¼š0 æ¬¡ï¼ˆä½¿ç”¨ç¼“å­˜ï¼‰
å¼‚æ­¥å†™å…¥ï¼š1 æ¬¡
```

**æ€§èƒ½å¯¹æ¯”ï¼š**
- âœ… æ‰§è¡Œé€Ÿåº¦ï¼šåŸºæœ¬æŒå¹³ï¼ˆç”šè‡³ç•¥å¿«ï¼‰
- âœ… ç”¨æˆ·ä½“éªŒï¼šæ›´å¥½ï¼ˆæ— éœ€é…ç½®å‡­è¯ï¼‰
- âš ï¸ ç³»ç»Ÿå¤æ‚åº¦ï¼šå¢åŠ ï¼ˆéœ€è¦ç®¡ç†å¹³å°é…ç½®å’Œè®¡è´¹ï¼‰

---

### 6.2 Notion èŠ‚ç‚¹æ‰§è¡Œæµç¨‹

#### æ”¹é€ å‰
```
1. ç”¨æˆ·åˆ›å»º Notion å‡­è¯
   â†’ è¾“å…¥ API Token
   â†“
2. ç”¨æˆ·æ‹–å…¥ Notion èŠ‚ç‚¹
   â†“
3. ç”¨æˆ·é€‰æ‹©å‡­è¯
   â†“
4. æ‰§è¡Œå·¥ä½œæµ
   â†’ Credentials.get('notionApi', userId)
   â†’ è°ƒç”¨ Notion API

æ€»æ­¥éª¤ï¼š4 æ­¥
ç”¨æˆ·æ“ä½œï¼š3 æ¬¡
```

#### æ”¹é€ åï¼ˆèŠ‚ç‚¹å‚æ•°æ¨¡å¼ï¼‰
```
1. ç”¨æˆ·æ‹–å…¥ Notion èŠ‚ç‚¹
   â†“
2. ç”¨æˆ·åœ¨èŠ‚ç‚¹å‚æ•°è¾“å…¥ API Token
   â†“
3. æ‰§è¡Œå·¥ä½œæµ
   â†’ ç›´æ¥ä»å‚æ•°è¯»å– Token
   â†’ è°ƒç”¨ Notion API

æ€»æ­¥éª¤ï¼š3 æ­¥
ç”¨æˆ·æ“ä½œï¼š2 æ¬¡
```

**ç”¨æˆ·ä½“éªŒå¯¹æ¯”ï¼š**
- âœ… æ­¥éª¤å‡å°‘ï¼šä» 4 æ­¥ â†’ 3 æ­¥
- âœ… æ“ä½œç®€åŒ–ï¼šæ— éœ€åˆ›å»ºå‡­è¯
- âš ï¸ å¤ç”¨æ€§ä¸‹é™ï¼šæ¯ä¸ªèŠ‚ç‚¹éœ€è¦å•ç‹¬é…ç½®
- âš ï¸ å®‰å…¨æ€§é™ä½ï¼šToken æ˜æ–‡å­˜å‚¨åœ¨å·¥ä½œæµå®šä¹‰ä¸­

---

## ä¸ƒã€ç»“è®ºä¸å»ºè®®

### 7.1 æ ¸å¿ƒç»“è®º

| é—®é¢˜ | ç»“è®º |
|------|------|
| **çº¯åŠŸèƒ½èŠ‚ç‚¹æ˜¯å¦éœ€è¦åŠ¨æ€åŒ–ï¼Ÿ** | âŒ **ä¸éœ€è¦**ï¼Œä¿æŒé™æ€ç¼–è¯‘ |
| **åŠ¨æ€åŒ–æ˜¯å¦å½±å“å·¥ä½œæµæ‰§è¡Œï¼Ÿ** | âœ… **åŸºæœ¬ä¸å½±å“**ï¼Œé…ç½®æ¥æºæ”¹å˜ä½†æ‰§è¡Œé€»è¾‘ä¸å˜ |
| **æ€§èƒ½æ˜¯å¦ä¼šä¸‹é™ï¼Ÿ** | âœ… **ä¸ä¼š**ï¼Œé€šè¿‡ç¼“å­˜å¯ä»¥è¾¾åˆ°ç›¸åŒç”šè‡³æ›´å¥½çš„æ€§èƒ½ |
| **æ˜¯å¦å­˜åœ¨æŠ€æœ¯é£é™©ï¼Ÿ** | âš ï¸ **å­˜åœ¨**ï¼Œä¸»è¦æ˜¯å‡­è¯è¿ç§»å’Œè®¡è´¹å‡†ç¡®æ€§ |

---

### 7.2 æ¨èæ–¹æ¡ˆ

#### æ–¹æ¡ˆï¼šé™æ€ + åŠ¨æ€æ··åˆæ¶æ„

```
â”œâ”€â”€ é™æ€èŠ‚ç‚¹ï¼ˆ139 ä¸ªï¼‰
â”‚   â”œâ”€â”€ ç¼–è¯‘åˆ° nodes.json
â”‚   â”œâ”€â”€ å¯åŠ¨æ—¶åŠ è½½åˆ°å†…å­˜
â”‚   â”œâ”€â”€ å‰ç«¯ç›´æ¥åŠ è½½
â”‚   â””â”€â”€ é›¶æ”¹é€ æˆæœ¬
â”‚
â””â”€â”€ åŠ¨æ€èŠ‚ç‚¹ï¼ˆ505 ä¸ªï¼‰
    â”œâ”€â”€ å¹³å°é…ç½®èŠ‚ç‚¹ï¼ˆ83 ä¸ªï¼‰
    â”‚   â”œâ”€â”€ AI æ¨¡å‹ï¼ˆ28 ä¸ªï¼‰
    â”‚   â”œâ”€â”€ Embeddingsï¼ˆ5 ä¸ªï¼‰
    â”‚   â”œâ”€â”€ AI å·¥å…·ï¼ˆSerpApi, WolframAlphaï¼‰
    â”‚   â””â”€â”€ å®˜æ–¹æ’ä»¶ï¼ˆæœªæ¥å¼€å‘ï¼‰
    â”‚
    â””â”€â”€ ç”¨æˆ·é…ç½®èŠ‚ç‚¹ï¼ˆ422 ä¸ªï¼‰
        â”œâ”€â”€ ç¬¬ä¸‰æ–¹æœåŠ¡ï¼ˆ300+ ä¸ªï¼‰
        â”œâ”€â”€ Vector Storeï¼ˆ14 ä¸ªï¼‰
        â”œâ”€â”€ Memoryï¼ˆ6 ä¸ªï¼‰
        â””â”€â”€ å…¶ä»–éœ€è¦ Key çš„èŠ‚ç‚¹
```

---

### 7.3 å®æ–½å»ºè®®

#### Phase 1ï¼šæ ¸å¿ƒåŸºç¡€ï¼ˆ2-3 å‘¨ï¼‰

```
âœ“ æ•°æ®åº“è®¾è®¡
  - platform_servicesï¼ˆå¹³å°é…ç½®ï¼‰
  - managed_nodesï¼ˆèŠ‚ç‚¹ç®¡ç†ï¼‰
  - workspace_service_usageï¼ˆä½¿ç”¨é‡ï¼‰

âœ“ åç«¯å®ç°
  - PlatformConfigServiceï¼ˆå¹³å°é…ç½®æœåŠ¡ï¼‰
  - NodeLoaderServiceï¼ˆåŠ¨æ€èŠ‚ç‚¹åŠ è½½ï¼‰
  - UsageTrackingServiceï¼ˆä½¿ç”¨é‡è¿½è¸ªï¼‰
  - CacheServiceï¼ˆRedis ç¼“å­˜ï¼‰

âœ“ AI å¤§æ¨¡å‹æ¥å…¥ï¼ˆ10-15 ä¸ªï¼‰
  - OpenAI, Claude, Gemini
  - Embeddings
```

#### Phase 2ï¼šç”¨æˆ·é…ç½®ä¼˜åŒ–ï¼ˆ2-3 å‘¨ï¼‰

```
âœ“ èŠ‚ç‚¹å‚æ•°æ¨¡å¼
  - ç§»é™¤ credentials å­—æ®µ
  - æ”¹ä¸ºèŠ‚ç‚¹å‚æ•°è¾“å…¥
  - æ”¯æŒ Workspace çº§åˆ«ä¿å­˜

âœ“ å‡­è¯è¿ç§»
  - è¿ç§»è„šæœ¬
  - å‘åå…¼å®¹
```

#### Phase 3ï¼šç›‘æ§ä¸è®¡è´¹ï¼ˆ1-2 å‘¨ï¼‰

```
âœ“ ä½¿ç”¨é‡ç›‘æ§
  - å®æ—¶ç»Ÿè®¡
  - é…é¢é¢„è­¦

âœ“ è®¡è´¹ç³»ç»Ÿ
  - æŒ‰é‡è®¡è´¹
  - å…è´¹é¢åº¦
  - è´¦å•ç”Ÿæˆ
```

---

### 7.4 æŠ€æœ¯ä¿éšœæªæ–½

| æªæ–½ | ç›®çš„ | å®ç°æ–¹å¼ |
|------|------|---------|
| **å‘åå…¼å®¹** | ä¸å½±å“ç°æœ‰å·¥ä½œæµ | ä¿ç•™å‡­è¯ç³»ç»Ÿä½œä¸º fallback |
| **æ€§èƒ½ä¼˜åŒ–** | é¿å…å»¶è¿Ÿå¢åŠ  | Redis ç¼“å­˜ + é¢„åŠ è½½ |
| **å®‰å…¨åŠ å›º** | ä¿æŠ¤å¹³å°é…ç½® | åŠ å¯†å­˜å‚¨ + æƒé™éš”ç¦» |
| **ç›‘æ§å‘Šè­¦** | åŠæ—¶å‘ç°é—®é¢˜ | æ—¥å¿— + æŒ‡æ ‡ + å‘Šè­¦ |
| **ç°åº¦å‘å¸ƒ** | é™ä½é£é™© | æŒ‰ Workspace ç°åº¦ |
| **å›æ»šæœºåˆ¶** | å¿«é€Ÿæ¢å¤ | åŠŸèƒ½å¼€å…³ + æ•°æ®å¤‡ä»½ |

---

## å…«ã€é£é™©è¯„ä¼°çŸ©é˜µ

| é£é™© | å½±å“ | æ¦‚ç‡ | ç­‰çº§ | ç¼“è§£æªæ–½ |
|------|------|------|------|---------|
| **å‡­è¯è¿ç§»å¤±è´¥** | ç”¨æˆ·å·¥ä½œæµä¸å¯ç”¨ | ä¸­ | ğŸ”´ é«˜ | å……åˆ†æµ‹è¯• + å›æ»šæœºåˆ¶ |
| **è®¡è´¹é”™è¯¯** | è´¢åŠ¡æŸå¤± | ä½ | ğŸ”´ é«˜ | äº‹åŠ¡ä¿è¯ + å¯¹è´¦ç³»ç»Ÿ |
| **æ€§èƒ½ä¸‹é™** | ç”¨æˆ·ä½“éªŒå˜å·® | ä½ | ğŸŸ¡ ä¸­ | ç¼“å­˜ + ç›‘æ§ |
| **é…ç½®æ³„éœ²** | å®‰å…¨é—®é¢˜ | ä½ | ğŸ”´ é«˜ | åŠ å¯† + å®¡è®¡æ—¥å¿— |
| **å¤šç§Ÿæˆ·å†²çª** | æ•°æ®æ··ä¹± | ä½ | ğŸ”´ é«˜ | Workspace éš”ç¦» |

---

## ä¹ã€é™„å½•

### 9.1 å®Œæ•´èŠ‚ç‚¹æ¸…å•

è¯¦è§ï¼š
- `node-analysis-result-v2.json` - æ™®é€šèŠ‚ç‚¹åˆ†æ
- `ai-nodes-analysis.json` - AI èŠ‚ç‚¹åˆ†æ

### 9.2 ç›¸å…³æ–‡æ¡£

- `01-æ¶æ„åº•å±‚æ”¹é€ æ–¹æ¡ˆ.md` - å¤šç§Ÿæˆ·æ¶æ„
- `02-èŠ‚ç‚¹åˆ†ç±»å’Œé…ç½®ç­–ç•¥.md` - èŠ‚ç‚¹é…ç½®ç­–ç•¥

---

**æ–‡æ¡£ç‰ˆæœ¬ï¼š** v1.0
**æœ€åæ›´æ–°ï¼š** 2025-11-07
**ä¸‹ä¸€æ­¥ï¼š** å¼€å§‹æ•°æ®åº“è®¾è®¡å’Œåç«¯å®ç°
